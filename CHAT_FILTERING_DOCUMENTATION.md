# Фильтрация чатов по времени

Добавлена возможность фильтрации чатов по временному диапазону в методах получения назначенных и неназначенных чатов.

## Изменения в API

### Методы с поддержкой фильтрации по времени:

1. `GET /api/chat-assignment/my-assigned` - получение назначенных чатов
2. `GET /api/chat-assignment/unassigned` - получение неназначенных чатов

### Параметры запроса:

- `from` (необязательный) - дата и время начала периода в формате ISO 8601
- `to` (необязательный) - дата и время окончания периода в формате ISO 8601

**Важно:** Если параметр `to` не указан, но указан `from`, то будет использовано текущее время.

## Примеры использования

### 1. Получение чатов за последние 24 часа:
```bash
GET /api/chat-assignment/my-assigned?from=2024-01-19T00:00:00Z&to=2024-01-20T00:00:00Z
```

### 2. Получение чатов с определенной даты до сейчас:
```bash
GET /api/chat-assignment/my-assigned?from=2024-01-19T12:00:00Z
```

### 3. Получение чатов до определенной даты:
```bash
GET /api/chat-assignment/unassigned?to=2024-01-19T23:59:59Z
```

### 4. Получение чатов за конкретный час:
```bash
GET /api/chat-assignment/my-assigned?from=2024-01-19T14:00:00Z&to=2024-01-19T15:00:00Z
```

## Формат ответа

Ответ теперь включает дополнительную информацию о примененных фильтрах:

```json
{
  "chats": [
    {
      "id": 1,
      "name": "Client Chat",
      "lastMessageAt": "2024-01-19T14:30:00Z",
      "priority": "normal",
      "unreadCount": 3,
      "status": "open",
      "assignedUser": {
        "id": 5,
        "name": "Оператор Иван",
        "email": "ivan@company.com"
      },
      "lastMessage": {
        "id": 123,
        "content": "Последнее сообщение",
        "timestamp": "2024-01-19T14:30:00Z",
        "fromMe": false,
        "type": "text"
      }
    }
  ],
  "total": 1,
  "filters": {
    "from": "2024-01-19T12:00:00Z",
    "to": "2024-01-19T15:00:00Z"
  }
}
```

## Технические детали

### Фильтрация происходит по полю `lastMessageAt`
Это означает, что возвращаются чаты, в которых последнее сообщение было отправлено в указанный временной период.

### Валидация дат
- Даты должны быть в корректном формате ISO 8601
- При некорректной дате возвращается ошибка 400 с описанием проблемы

### Примеры форматов дат:
- `2024-01-19T14:30:00Z` (UTC время)
- `2024-01-19T14:30:00+03:00` (с указанием часового пояса)
- `2024-01-19T14:30:00` (локальное время)

## Примеры cURL команд

### Получить назначенные чаты за сегодня:
```bash
curl -X GET "http://localhost:3000/api/chat-assignment/my-assigned?from=2024-01-19T00:00:00Z&to=2024-01-19T23:59:59Z" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

### Получить неназначенные чаты за последние 6 часов:
```bash
curl -X GET "http://localhost:3000/api/chat-assignment/unassigned?from=2024-01-19T08:00:00Z" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

## Сортировка результатов

Чаты по-прежнему сортируются в следующем порядке:
1. По приоритету (urgent > high > normal > low)
2. По количеству непрочитанных сообщений (больше сверху)
3. По времени последнего сообщения (новые сверху)

Фильтрация по времени применяется до сортировки.
