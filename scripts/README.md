# üìú –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

–ö–æ–ª–ª–µ–∫—Ü–∏—è —É—Ç–∏–ª–∏—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏ messenger-backend.

## üìÅ –°–ø–∏—Å–æ–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤

### üóëÔ∏è –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

| –°–∫—Ä–∏–ø—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|--------|----------|--------------|--------------|
| `clear-all-data.sql` | SQL —Å–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è | ‚ö†Ô∏è –ù–µ—Ç –±—ç–∫–∞–ø–∞ | –¢–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| `clear-all-chats-messages.js` | Node.js —Å–∫—Ä–∏–ø—Ç —Å dry-run | ‚úÖ Dry-run —Ä–µ–∂–∏–º | –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è |
| `clear-all-chats-messages-with-backup.js` | Node.js —Å –∞–≤—Ç–æ–±—ç–∫–∞–ø–æ–º | ‚úÖ‚úÖ –ü–æ–ª–Ω—ã–π –±—ç–∫–∞–ø | –î–ª—è production |

### üîß –ú–∏–≥—Ä–∞—Ü–∏–∏

| –°–∫—Ä–∏–ø—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| `migrate-ticket-numbers.js` | –ú–∏–≥—Ä–∞—Ü–∏—è –Ω—É–º–µ—Ä–∞—Ü–∏–∏ —Ç–∏–∫–µ—Ç–æ–≤ |
| `test-ticket-reopen.js` | –¢–µ—Å—Ç –ø–µ—Ä–µ–æ—Ç–∫—Ä—ã—Ç–∏—è —Ç–∏–∫–µ—Ç–æ–≤ |
| `clean-app-state.js` | –û—á–∏—Å—Ç–∫–∞ app-state-sync-key |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: SQL (—Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π)

```bash
# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø
pg_dump -U postgres messenger_db > backup.sql

# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
psql -U postgres -d messenger_db -f scripts/clear-all-data.sql
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: Node.js –±–µ–∑ –±—ç–∫–∞–ø–∞

```bash
# Dry-run (–ø—Ä–æ—Å–º–æ—Ç—Ä –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è)
node scripts/clear-all-chats-messages.js --dry-run

# –†–µ–∞–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
node scripts/clear-all-chats-messages.js
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: Node.js —Å –∞–≤—Ç–æ–±—ç–∫–∞–ø–æ–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –£–¥–∞–ª–µ–Ω–∏–µ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–æ–∑–¥–∞–Ω–∏–µ–º –±—ç–∫–∞–ø–∞
node scripts/clear-all-chats-messages-with-backup.js

# –£–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –∫ –±—ç–∫–∞–ø—É
node scripts/clear-all-chats-messages-with-backup.js --backup-dir /path/to/backups
```

---

## üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –≤:
- [`CLEAR_DATA_GUIDE.md`](../CLEAR_DATA_GUIDE.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ—á–∏—Å—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö

---

## ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

### –ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–∫—Ä–∏–ø—Ç–æ–≤:

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –ë–î**
   ```bash
   pg_dump -U postgres messenger_db > backup-$(date +%Y%m%d-%H%M%S).sql
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   ```bash
   echo $DATABASE_URL
   ```

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ dry-run —Ä–µ–∂–∏–º**
   ```bash
   node scripts/clear-all-chats-messages.js --dry-run
   ```

4. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ production –±–µ–∑ –±—ç–∫–∞–ø–∞**

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –£—Ä–æ–≤–Ω–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤:

| –£—Ä–æ–≤–µ–Ω—å | –°–∫—Ä–∏–ø—Ç | –ó–∞—â–∏—Ç–∞ |
|---------|--------|--------|
| üî¥ **–ù–∏–∑–∫–∏–π** | `clear-all-data.sql` | –¢–æ–ª—å–∫–æ 5-—Å–µ–∫—É–Ω–¥–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ |
| üü° **–°—Ä–µ–¥–Ω–∏–π** | `clear-all-chats-messages.js` | Dry-run + –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ |
| üü¢ **–í—ã—Å–æ–∫–∏–π** | `clear-all-chats-messages-with-backup.js` | –ê–≤—Ç–æ–±—ç–∫–∞–ø + dry-run + –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

- **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: –õ—é–±–æ–π —Å–∫—Ä–∏–ø—Ç
- **Staging**: `clear-all-chats-messages.js` —Å dry-run
- **Production**: –¢–û–õ–¨–ö–û `clear-all-chats-messages-with-backup.js`

---

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î"

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DATABASE_URL
echo $DATABASE_URL

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
export DATABASE_URL="postgresql://user:password@localhost:5432/messenger_db"
```

### –ü—Ä–æ–±–ª–µ–º–∞: "pg_dump not found"

```bash
# macOS
brew install postgresql

# Ubuntu/Debian
sudo apt-get install postgresql-client
```

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤"

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è PostgreSQL
psql -U postgres -c "\du"

# –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∞
psql -U postgres -c "GRANT ALL ON DATABASE messenger_db TO your_user;"
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `tail -f logs/app.log`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ë–î: `psql -U postgres messenger_db -c "\dt"`
3. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏: `CLEAR_DATA_GUIDE.md`

---

**–°–æ–∑–¥–∞–Ω–æ**: 2025
**–í–µ—Ä—Å–∏—è**: 1.0.0
